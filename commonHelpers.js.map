{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function searchImages(query, currentPage) {\n  const params = {\n    key: '44431015-10991196da62062e34a604eda',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 15,\n    page: currentPage,\n  };\n  try {\n    const { data } = await axios.get('', { params });\n    return data;\n  } catch (err) {\n    console.log('server error', err);\n  }\n}\n","export function imageTemplate({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-item\"><a href=\"${largeImageURL}\" class=\"gallery-link\"><img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-img\"/></a>\n  <ul class=\"descr\">\n      <li class=\"descr-item\">\n        <p><b>Likes</b></p>\n        <p>${likes}</p>\n      </li>\n      <li class=\"descr-item\">\n        <p><b>Views</b></p>\n        <p>${views}</p>\n      </li>\n      <li class=\"descr-item\">\n        <p><b>Comments</b></p>\n        <p>${comments}</p>\n      </li>\n      <li class=\"descr-item\">\n        <p><b>Downloads</b></p>\n        <p>${downloads}</p>\n      </li>\n    </ul>\n    </li>`;\n}\n\nexport function imagesTemplate(images) {\n  return images.map(imageTemplate).join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { searchImages } from './js/pixabay-api';\nimport { imagesTemplate } from './js/render-functions';\n\nconst formSearch = document.querySelector('.form');\nconst galleryElem = document.querySelector('.gallery');\nconst loaderElem = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.loadmore-btn');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nlet searchValue;\nlet currentPage = 1;\nlet maxPage = 1;\nconst perPage = 15;\n\nformSearch.addEventListener('submit', onSearchBtnSubmit);\n\nasync function onSearchBtnSubmit(event) {\n  event.preventDefault();\n\n  searchValue = formSearch.elements.search.value.trim();\n\n  if (searchValue === '') {\n    galleryElem.innerHTML = '';\n    displayMessage('Please enter data for search', '#ffa000');\n    return;\n  }\n  showLoader();\n  hideLoadBtn();\n  try {\n    currentPage = 1;\n    const data = await searchImages(searchValue, currentPage);\n    maxPage = Math.ceil(data.total / perPage);\n\n    if (data.hits.length === 0) {\n      galleryElem.innerHTML = '';\n      displayMessage(\n        'Sorry, there are no images matching your search query. Please try again!',\n        '#ef4040'\n      );\n      hideLoader();\n      updateBtnStatus();\n      return;\n    } else {\n      const markup = imagesTemplate(data.hits);\n      galleryElem.innerHTML = markup;\n\n      lightbox.refresh();\n    }\n  } catch (err) {\n    displayMessage(\n      'An error occurred while fetching photos. Please try again later.',\n      '#EF4040'\n    );\n  }\n  updateBtnStatus();\n  hideLoader();\n  formSearch.reset();\n}\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage++;\n  hideLoadBtn();\n  showLoader();\n\n  try {\n    const data = await searchImages(searchValue, currentPage);\n    const markup = imagesTemplate(data.hits);\n    galleryElem.insertAdjacentHTML('beforeend', markup);\n    scrollOldElements();\n  } catch (err) {\n    displayMessage(\n      'An error occurred while fetching photos. Please try again later.',\n      '#EF4040'\n    );\n  }\n\n  lightbox.refresh();\n\n  hideLoader();\n  updateBtnStatus();\n});\n\nfunction displayMessage(message, color) {\n  iziToast.show({\n    message: message,\n    position: 'topRight',\n    backgroundColor: color,\n    messageColor: '#fff',\n    theme: 'dark',\n    maxWidth: '350px',\n  });\n}\n\nfunction showLoader() {\n  loaderElem.classList.remove('visually-hidden');\n}\n\nfunction hideLoader() {\n  loaderElem.classList.add('visually-hidden');\n}\n\nfunction showLoadBtn() {\n  loadMoreBtn.classList.remove('visually-hidden');\n}\n\nfunction hideLoadBtn() {\n  loadMoreBtn.classList.add('visually-hidden');\n}\nfunction updateBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideLoadBtn();\n    if (maxPage) {\n      displayMessage(\n        'We are sorry, but you have reached the end of search results.',\n        '#89CFF0'\n      );\n    }\n  } else {\n    showLoadBtn();\n  }\n}\n\nfunction scrollOldElements() {\n  const liElem = galleryElem.children[0];\n  const height = liElem.getBoundingClientRect().height;\n  scrollBy({\n    top: height * 3 + 72,\n    behavior: 'smooth',\n  });\n}\n"],"names":["axios","searchImages","query","currentPage","params","data","err","imageTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imagesTemplate","images","formSearch","galleryElem","loaderElem","loadMoreBtn","lightbox","SimpleLightbox","searchValue","maxPage","perPage","onSearchBtnSubmit","event","displayMessage","showLoader","hideLoadBtn","hideLoader","updateBtnStatus","markup","scrollOldElements","message","color","iziToast","showLoadBtn","height"],"mappings":"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"}